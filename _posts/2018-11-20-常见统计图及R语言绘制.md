---
layout: post
title:  "常见统计图及R语言绘制"
category: 'bigdata'
tags: 统计图
author: y570pc
image: 
---

## 韦恩图（Venn diagram）

#### 基础

```R
library(VennDiagram)
venn.diagram(list(A=1:10,B=3:13,C=c(6:9,-3:0,15:18)), fill=c("red","green","blue"), alpha=c(0.5,0.5,0.5), cex=2, cat.fontface=4, fontfamily=3, filename="VennDiagram.tiff")
```

## 聚类图

```R
site="https:\\mirrors.tuna.tsinghua.edu.cn\CRAN"
package_list = c("factoextra","cluster")
for(p in package_list){
  if(!suppressWarnings(suppressMessages(require(p, character.only = TRUE, quietly = TRUE, warn.conflicts = FALSE)))){
    install.packages(p, repos=site)
    suppressWarnings(suppressMessages(library(p, character.only = TRUE, quietly = TRUE, warn.conflicts = FALSE)))
  }
}
data("USArrests")
USArrests = na.omit(USArrests)
desc_stats = data.frame( Min=apply(USArrests, 2, min),#minimum
                         Med=apply(USArrests, 2, median),#median
                         Mean=apply(USArrests, 2, mean),#mean
                         SD=apply(USArrests, 2, sd),#Standard deviation
                         Max=apply(USArrests, 2, max)#maximum
)
desc_stats = round(desc_stats, 1)#保留小数点后一位head(desc_stats)
df = scale(USArrests)  #对数据中心化和标准化
res = get_clust_tendency(df, 40, graph = TRUE)
res$hopkins_stat   #Hopkins统计量的值<0.5，表明数据是高度可聚合的
res$plot
set.seed(123)
## Compute the gap statistic
gap_stat = clusGap(df, FUN = kmeans, nstart = 25, K.max = 10, B = 500)  #估计聚合簇数
# Plot the result
fviz_gap_stat(gap_stat)
km.res = kmeans(df, 4, nstart = 25)
# Visualize clusters using factoextra
fviz_cluster(km.res, USArrests)
sil = silhouette(km.res$cluster, dist(df))  #提取聚类轮廓图
rownames(sil) = rownames(USArrests)
head(sil[, 1:3])
fviz_silhouette(sil)
neg_sil_index = which(sil[, "sil_width"] < 0)
sil[neg_sil_index, , drop = FALSE]
###eclust():增强的聚类分析
# Compute k-means
res.km = eclust(df, "kmeans")
# Gap statistic plot
fviz_gap_stat(res.km$gap_stat)
# Enhanced hierarchical clustering
res.hc = eclust(df, "hclust") # compute hclust
fviz_dend(res.hc, rect = TRUE) # dendrogam
fviz_silhouette(res.hc) # silhouette plot
fviz_cluster(res.hc) # scatter plot
```
结果
![01](./img/2018-11-20-01.png)

## 折线图

#### 基础

数据
```
时间,全社会最大负荷,预测方法
2019年,602.84,最大负荷利用小时法
2020年,665.53,最大负荷利用小时法
2021年,734.75,最大负荷利用小时法
2022年,811.16,最大负荷利用小时法
2023年,895.52,最大负荷利用小时法
2019年,585.09,分区增长率法
2020年,652.28,分区增长率法
2021年,716.32,分区增长率法
2022年,805.91,分区增长率法
2023年,890.27,分区增长率法
2019年,570.23,自然增长加大用户法
2020年,639.25,自然增长加大用户法
2021年,713.17,自然增长加大用户法
2022年,795.49,自然增长加大用户法
2023年,888.034,自然增长加大用户法
```
代码
```R
library(ggplot2)
df2<-read.csv("C:\\Users\\Administrator\\Desktop\\data01.csv",header=T,sep=",")
p<-ggplot(df2, aes(x=时间, y=全社会最大负荷, group=预测方法)) +
  geom_line(aes(color=预测方法),size=1.5)+
  geom_point(aes(color=预测方法),size=3)+
  ggtitle("基于不同方法预测长丰县全社会最大负荷趋势图")+
  theme(plot.title = element_text(hjust = 0.5,size=20,face="bold"),axis.title=element_text(face="bold"),
        axis.text=element_text(face="bold"))
p
```
结果
![02](./img/2018-11-20-02.png)

